---
import Layout from '../../layouts/Layout.astro';
import { blogPosts } from '../../data/blogPosts';

export function getStaticPaths() {
  return blogPosts.map((post) => ({
    params: { slug: post.slug },
    props: { post },
  }));
}

const { post } = Astro.props;

// Función simple para convertir markdown a HTML (para headers y párrafos básicos)
function parseMarkdown(content: string) {
  return content
    .split('\n')
    .map((line) => {
      // Headers
      if (line.startsWith('### ')) {
        return `<h3 class="text-xl font-bold mt-8 mb-4">${line.replace('### ', '')}</h3>`;
      }
      if (line.startsWith('## ')) {
        return `<h2 class="text-2xl font-bold mt-10 mb-4">${line.replace('## ', '')}</h2>`;
      }
      if (line.startsWith('# ')) {
        return `<h1 class="text-3xl font-bold mb-6">${line.replace('# ', '')}</h1>`;
      }
      // Bold text
      if (line.includes('**')) {
        line = line.replace(/\*\*(.*?)\*\*/g, '<strong class="font-bold">$1</strong>');
      }
      // Lists
      if (line.startsWith('- ')) {
        return `<li class="ml-6 mb-2">${line.replace('- ', '')}</li>`;
      }
      // Empty lines
      if (line.trim() === '') {
        return '<div class="h-4"></div>';
      }
      // Regular paragraphs
      if (line.trim() !== '') {
        return `<p class="mb-4 leading-relaxed">${line}</p>`;
      }
      return '';
    })
    .join('\n');
}

const htmlContent = parseMarkdown(post.contenido);
---

<Layout title={`${post.titulo} - Blog - Cristian Ramírez`} description={post.extracto}>
  <!-- Header -->
  <section class="bg-black text-white py-16">
    <div class="container mx-auto px-4">
      <div class="max-w-4xl mx-auto">
        <div class="mb-4">
          <span class="inline-block bg-[#01b5df] text-white text-xs px-3 py-1 rounded-full font-semibold">
            {post.categoria}
          </span>
          <span class="ml-4 text-sm text-gray-300">{post.fecha}</span>
        </div>
        <h1 class="text-3xl md:text-5xl font-bold mb-4">{post.titulo}</h1>
        <p class="text-xl text-gray-300">{post.extracto}</p>
      </div>
    </div>
  </section>

  <!-- Article Content -->
  <article class="py-16 md:py-24 overflow-x-hidden">
    <div class="container mx-auto px-4">
      <div class="max-w-4xl mx-auto">
        <div class="prose prose-lg max-w-none text-gray-700 break-words">
          <Fragment set:html={htmlContent} />
        </div>

        <!-- Author Info -->
        <div class="mt-16 pt-8 border-t border-gray-200">
          <div class="flex items-center">
            <img
              src="/me.jpg"
              alt="Cristian Ramírez"
              class="w-16 h-16 rounded-full mr-4 object-cover object-top"
            />
            <div>
              <h3 class="text-lg font-bold mb-1">Cristian Ramírez</h3>
              <p class="text-gray-600 text-sm">
                Facilitador y consultor especializado en desarrollo de talento humano y
                transformación organizacional.
              </p>
            </div>
          </div>
        </div>

        <!-- Navigation -->
        <div class="mt-12 flex justify-between items-center">
          <a
            href="/blog"
            class="inline-flex items-center text-black font-semibold hover:text-gray-700 transition-colors"
          >
            <svg
              class="w-4 h-4 mr-2"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M15 19l-7-7 7-7"></path>
            </svg>
            Volver al blog
          </a>
          <a
            href="/contacto"
            class="bg-black text-white px-6 py-3 rounded-md font-semibold hover:bg-gray-800 transition-colors"
          >
            Contáctame
          </a>
        </div>
      </div>
    </div>
  </article>

  <!-- Related or CTA Section -->
  <section class="bg-gray-50 py-16">
    <div class="container mx-auto px-4 text-center">
      <h2 class="text-3xl font-bold mb-4">¿Te gustó este artículo?</h2>
      <p class="text-xl text-gray-600 mb-8 max-w-2xl mx-auto">
        Explora más artículos sobre liderazgo, capacitación y desarrollo organizacional
      </p>
      <a
        href="/blog"
        class="inline-block bg-black text-white px-8 py-3 rounded-md font-semibold hover:bg-gray-800 transition-colors"
      >
        Ver todos los artículos
      </a>
    </div>
  </section>
</Layout>
